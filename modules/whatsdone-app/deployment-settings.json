{
  "moduleName": "whatsdone-app",
  "outputsStore": {
    "type": "s3-bucket",
    "region": {"$ref": "#/_args/region"},
    "bucket": "whatsdone-deployment-outputs",
    "prefix": {"Fn::Join": ["/", [{"$ref": "#/_env"}, "whatsdone-app"]]}
  },
  "tasks": [
    {
      "id": "build-lambda-app",
      "type": "custom",
      "run": {
        "script": "./build.sh"
      }
    },
    {
      "id": "package-lambda",
      "type": "custom",
      "run": {
        "script": "kumo upload-package --build-number $BUILD_NUMBER --region $TASK_REGION --upload-bucket lambda-packages-cg3j2bu2 --output $TASK_OUTPUTS_FILE",
        "envVars": {
          "TASK_REGION": {"$ref": "#/_taskRegion"},
          "TASK_OUTPUTS_FILE": {"$ref": "#/_taskOutputsFile"}
        }
      },
      "outputsName": "packages"
    }
  ]
}
