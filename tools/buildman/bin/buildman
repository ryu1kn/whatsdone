#!/usr/bin/env node

const {spawnSync} = require('child_process');
const path = require('path');
const configPath = path.join(process.cwd(), 'buildman.config.js');
const config = require(configPath);

const buildman = require('../index');
const params = {
  config,
  stdin: process.stdin,
  stdout: process.stdout,
  stderr: process.stderr,
  spawnSync,
  envVars: process.env,
  logger: console
};
buildman(params).catch(e => {
  setTimeout(() => {
    throw e;
  }, 0);
});
